import{d as e,r as l,g as o,m as a,n as t,e as s,K as n,o as r,c as u,a as c,w as i,L as d,I as v,J as m,F as h,f as g,t as p,b}from"./vendor.59486093.js";import{r as f,a as C}from"./index.a0ab63f0.js";import"./main.fc5c0ef5.js";const w=e({setup(){const e=l(null),s=l([]),n=l(null),r=l(!1),u=l(!1),c=l("ADD"),i=l([]),d=l(0),v=l(""),m=l(""),h=l([]),g=o((()=>{var e="";return h.value.forEach((l=>{e+=l,e+=" "})),e=e.substring(0,e.length-1)}));function p(){r.value=!0,f({url:C.getAllRole.url,method:C.getAllRole.method}).then((l=>{200===l.Code?e.value=l.Data:(null!=n.value&&n.value.close(),n.value=a({message:"数据获取失败",type:"error",showClose:!0})),r.value=!1})).catch((e=>{console.log(e),r.value=!1}))}function b(){f({url:C.getAllPower.url.replace("/{id}",""),method:C.getAllPower.method}).then((e=>{200===e.Code&&(i.value=e.Data)})).catch((e=>{console.log(e)}))}function w(){u.value=!1,v.value="",m.value="",h.value.length=0}return{roleList:e,multipleSelection:s,tipBox:n,dialogVisible:u,dialogType:c,PowerAllList:i,roleId:d,roleName:v,roleRemark:m,rolePowerList:g,rolePowerListArray:h,loading:r,getData:p,getPower:b,selectedChange:function(e){s.value.length=0,e.forEach((e=>{s.value.push(e.RoleId)}))},handleClose:function(e){w(),e()},dialogClose:w,addRole:function(){f({url:C.createRole.url,method:C.createRole.method,data:{RoleName:v.value,RoleRemark:m.value,RolePowerList:g.value}}).then((e=>{null!=n.value&&n.value.close(),200===e.Code&&!0===e.Data?n.value=a({message:"添加成功",type:"success",showClose:!0}):n.value=a({message:"添加失败",type:"error",showClose:!0}),p()})).catch((e=>{null!=n.value&&n.value.close(),n.value=a({message:"添加失败",type:"error",showClose:!0}),console.log(e)})),w()},addClick:function(){b(),c.value="ADD",u.value=!0},editRole:function(){f({url:C.updateRole.url.replace("{id}",d.value),method:C.updateRole.method,data:{RoleName:v.value,RoleRemark:m.value,RolePowerList:g.value}}).then((e=>{null!=n.value&&n.value.close(),200===e.Code?n.value=a({message:"修改成功",type:"success",showClose:!0}):n.value=a({message:"修改失败",type:"error",showClose:!0}),p()})).catch((e=>{null!=n.value&&n.value.close(),n.value=a({message:"修改失败",type:"error",showClose:!0}),console.log(e)})),w()},editClick:function(e){b(),d.value=e.RoleId,v.value=e.RoleName,m.value=e.RoleRemark,h.value=e.RolePowerList.split(" "),c.value="EDIT",u.value=!0},removeClick:function(e){t.confirm("确定删除该角色？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{f({url:C.deleteRole.url.replace("{id}",e.RoleId),method:C.deleteRole.method}).then((e=>{null!=n.value&&n.value.close(),200===e.Code?n.value=a({message:"删除成功",type:"success",showClose:!0}):n.value=a({message:"删除失败",type:"error",showClose:!0}),p()})).catch((e=>{console.log(e)}))})).catch((()=>{}))},removeAll:function(){t.confirm("确定删除所选角色？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{var e=[];s.value.forEach((l=>{e.push(l)})),f({url:C.deleteMultipleRole.url,method:C.deleteMultipleRole.method,data:{RoleId:e}}).then((e=>{null!=n.value&&n.value.close(),n.value=a({message:"成功删除"+e.Data.count+"条记录",type:"success",showClose:!0}),p()})).catch((e=>{console.log(e),null!=n.value&&n.value.close(),n.value=a({message:"删除失败",type:"error",showClose:!0})}))})).catch((()=>{}))}}},beforeMount(){this.getData()}}),R={class:"px-20 py-10"},y={class:"grid grid-cols-1 md:grid-cols-3 pb-10 mr-1 grid-rows-1 justify-items-center"},k=c("div",null,null,-1),x=c("h1",{class:"text-2xl "},"角色管理",-1),P={class:"md:space-x-8 justify-self-end"},D=c("i",{class:"el-icon-plus"},null,-1),A=b(" 添 加 "),I=c("i",{class:"el-icon-refresh-left"},null,-1),L=b(" 刷 新 "),N={class:"mx-20 mt-2"},T={class:"float-left"},V={class:"float-right text-blue-400"},j={class:" space-x-5"},B={class:""},E={class:"mt-5"};w.render=function(e,l,o,a,t,b){const f=s("el-option"),C=s("el-select"),w=s("el-dialog"),_=s("el-table-column"),M=s("el-table"),S=n("loading");return r(),u("div",R,[c("div",y,[k,x,c("div",P,[c("button",{class:"btn bg-green-400 ring-green-400",onClick:l[1]||(l[1]=(...l)=>e.addClick&&e.addClick(...l))},[D,A]),c("button",{class:"btn bg-blue-400 ring-blue-400",onClick:l[2]||(l[2]=(...l)=>e.getData&&e.getData(...l))},[I,L])]),c(w,{"model-value":e.dialogVisible,title:"角色信息",width:"30%","before-close":e.handleClose,top:"20vh"},{footer:i((()=>[c("span",j,[c("button",{class:"btn-online hover:text-blue-400 hover:bg-blue-100 hover:border-blue-300",onClick:l[6]||(l[6]=(...l)=>e.dialogClose&&e.dialogClose(...l))},"取 消"),"ADD"===e.dialogType?(r(),u("button",{key:0,class:"btn bg-blue-400 ring-blue-400",onClick:l[7]||(l[7]=(...l)=>e.addRole&&e.addRole(...l))},"确 定")):d("",!0),"EDIT"===e.dialogType?(r(),u("button",{key:1,class:"btn bg-blue-400 ring-blue-400",onClick:l[8]||(l[8]=(...l)=>e.editRole&&e.editRole(...l))},"确 定")):d("",!0)])])),default:i((()=>[c("div",null,[v(c("input",{type:"text",class:"input-box m-20 w-4/6","onUpdate:modelValue":l[3]||(l[3]=l=>e.roleName=l),placeholder:"角色名称"},null,512),[[m,e.roleName]]),v(c("input",{type:"text",class:"input-box m-20 w-4/6","onUpdate:modelValue":l[4]||(l[4]=l=>e.roleRemark=l),placeholder:"角色描述"},null,512),[[m,e.roleRemark]]),c("div",N,[c(C,{modelValue:e.rolePowerListArray,"onUpdate:modelValue":l[5]||(l[5]=l=>e.rolePowerListArray=l),multiple:"",placeholder:"请选择权限"},{default:i((()=>[(r(!0),u(h,null,g(e.PowerAllList,(e=>(r(),u(f,{key:e.PowerId,label:e.PowerName,value:e.PowerId},{default:i((()=>[c("span",T,p(e.PowerName),1),c("span",V,p(e.PowerId),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["model-value","before-close"])]),c("div",B,[v(c(M,{data:e.roleList,border:"","empty-text":"暂无数据",onSelectionChange:e.selectedChange,style:{margin:"0 auto",width:"100%"}},{default:i((()=>[c(_,{type:"selection",width:"50"}),c(_,{prop:"RoleId",label:"角色编号",width:"100"}),c(_,{prop:"RoleName",label:"角色名称"}),c(_,{prop:"RoleRemark",label:"角色描述"}),c(_,{label:"操作",width:"150"},{default:i((l=>[c("span",{class:"text-indigo-400 link select-none",onClick:o=>e.editClick(l.row)},"编辑",8,["onClick"]),c("span",{class:"text-red-400 link select-none",onClick:o=>e.removeClick(l.row)},"删除",8,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),[[S,e.loading]]),c("div",E,[c("button",{class:"btn-online hover:bg-red-100 hover:border-red-300 hover:text-red-400",onClick:l[9]||(l[9]=(...l)=>e.removeAll&&e.removeAll(...l))}," 删除所有选择项 ")])])])};export default w;
